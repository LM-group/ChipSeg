'Main_OFFLINE.m' contains the main file to be run. If this file is run as it is, it will ask
questions to set up the entire algorithm.
Otherwise, the reader can set up directly the Cell Cluster segmentation experiment shown inside the manuscript commenting the first part of the main, uploading 'Parameters_for_Cluster_segmentation.mat' in the workspace
and finally running the section 'OFFLINE FUNCTION CALL' located at the bottom of 'Main_OFFLINE.m'. Some entries in the .mat file might be changed (e.g. path where images are located).

To reproduce results in the paper (Supporting Movie S2), '27Sept19_RexH2B_Relay75_SLPDCONbdye_LIF_DRCplurialg_LI2_36hri.mat' should be inside
the same folder. This file is automatically generated during our time-lapse experiments and contains 
multiple variables, among which the crop variables as well. If the reader wants to use the algorithm for novel experiments, s/he can manually crop images, both in regions containing cells, and to calculate the background. These will be then saved into a matlab data file called 'cropfiles.mat' with the name of 'crop' and 'CropRectBCKG'. If the user wants to load crops from 'cropfiles.mat', s/he must first rename the variable 'crop' into 'CropRect<i>' to indicate the position of interest, as this is the format accepted by the CROPfunction.
To change the matlab folder path, the user must update the variables Parameters.Paths.directory_mat_folder and Parameters.Paths.img_folder. Generally, if nothing is modified when downloading the code, the first variable is set to ‘.\’, which corresponds to the current folder for Windows operative systems, while the last variable is set the current image folders.

To reproduce tracking experiment results (Supporting Movie S3), the steps are similar, 
but 'Parameters_for_test_SingleCells.mat' has to be uploaded in the workspace. As above, some entries in the .mat file might be changed (e.g. path where images are located).
 The user then needs to run the section 'OFFLINE FUNCTION CALL' located at the bottom of 'Main_OFFLINE.m'. In this case the matlab data file 'cropfiles.mat' must be inside the folder. 
As above, to change the matlab folder path, the user must update the variables Parameters.Paths.directory_mat_folder and Parameters.Paths.img_folder. Generally, if nothing is modified when downloading the code, the first variable is set to ‘.\’, which corresponds to the current folder for Windows operative systems, while the last variable is set the current image folders.

'OFFLINE_function.m' is the matlab file called by the main. It contains most of the functions needed 
for the algorithm (CROPfunction, fileNames_addressFunction, mask_function, Generate_Video) to segment cells.

'Mask_n_Track.m' is the segmenting method needed in case of tracking single cells. It does not rely on the same 'mask_function' of cluster cells, and generates a different mask specifically formulated to
ease the tracking task.

'fluorescence_evaluation.m' is the function that computes fluorescence values, according to a given
segmented image.

The folder also contains:

Mark_and_Find_001: folder generated by the microscope, containing the mESCs line Rex1-GFPd2 raw images (Supporting Movie S2);
mat_figures_and_data_folder: it contains saved workspaces from experiments;
Position 3:  folder generated by the microscope, containing the dual-reporter mESCs raw images (Supporting Movie S3).
